import{r as o,j as e,z as y,y as x}from"./page-DYpLzGDn.js";import{I as n}from"./input-DoFBkTv9.js";import{S as h}from"./select-Bj28lnCQ.js";import{s as I}from"./receipt-service-X9co8Iga.js";import{u as b,a as E}from"./app-4Qj2AAUn.js";import{b as k}from"./product-search-IfNfm9Yt.js";import{L as g}from"./loading-CR1FM5vD.js";import{r as j}from"./routing-BzgBYGmF.js";import{j as w}from"./tickets-service-D5Iq8Wjr.js";import{s as c}from"./index-BrRvNckW.js";import"./index-DaPaTlHv.js";import"./asyncToGenerator-C4ZkcmSA.js";import"./render-DDfW_aRt.js";import"./CheckCircleFilled-Dta7NwZz.js";import"./pickAttrs-C-aTc6MT.js";import"./InfoCircleFilled-C1c2TBkr.js";import"./KeyCode-DNlgD2sM.js";import"./useCSSVarCls-zfTcjO9F.js";import"./useZIndex-DflanEq6.js";function Z(){const{ticket:s}=b(t=>t.tickets),{user:u}=b(t=>t.app),v=E(),[N,R]=o.useState([]),[p,l]=o.useState(!1);o.useState(!1);const[r,d]=o.useState({store:null,retailers_price:"0",discount:"0",total_price:"0",refurbished:"true",notes:null,reason:""});o.useEffect(()=>{d({...r,total_price:r.retailers_price})},[r.retailers_price]),o.useEffect(()=>{async function t(i){const _=await k();R(_.map(f=>({name:f,value:f}))),s!=null&&s.receipt&&d({...s.receipt,id:s.id})}t()},[]);function a(t,i){d({...r,[i]:t})}async function m(t){if(t.preventDefault(),r.store||c.error("Store Name is required!"),(!r.retailers_price||r.retailers_price=="0")&&c.error("Retailers is required!"),(!r.total_price||r.total_price=="0")&&c.error("Total Price is required!"),!r.notes)c.error("Notes is required!");else{l(!0);try{const i=await I({...s,...r,emp_id:u.emp_id});v(y(i.status)),l(!1),x.visit(j("decision"))}catch{l(!1)}}}async function S(){l(!0);try{await w(s,r.reason,{...s,...u}),x.visit(j("files"))}catch{l(!1)}}const A=["OOW","HAS PHYSICAL DAMAGE","REFURBISHED","UNAUTHORIZED RETAILER","NON-CURTIS PRODUCT (MODEL, SERIAL)","PHYSICAL DAMAGE - FRONT","PHYSICAL DAMAGE - BACK","SHIPPING DAMAGE","THIRD PARTY SELLER"];return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("div",{className:"text-4xl font-black",children:"Receipt details"}),e.jsxs("form",{className:"flex flex-col gap-4",onSubmit:m,children:[e.jsx(h,{onChange:a,name:"store",value:r.store,required:!0,label:"Store Name",errorMessage:"Store Name is required",data:N}),e.jsx(n,{span:"$",required:!0,onChange:a,name:"retailers_price",value:r.retailers_price,label:"Retailers Price",type:"text",errorMessage:"Retailers Price is required"}),e.jsx(n,{span:"$",onChange:a,name:"discount",value:r.discount,label:"Discount",type:"text",errorMessage:"Discount is required"}),e.jsx(n,{span:"$",required:!0,onChange:a,name:"total_price",value:parseFloat(r.retailers_price)-parseFloat(r.discount),label:"Total Price",type:"text",errorMessage:"Total Price is required"}),e.jsx(h,{onChange:a,name:"refurbished",value:r.refurbished,label:"Refurbished Logo?",errorMessage:"Refurbished is required",data:[{value:"true",name:"Yes"},{value:"false",name:"No"}]}),e.jsx(n,{onChange:a,name:"notes",value:r.notes,label:"Validation Notes",type:"text",errorMessage:"Validation Notes is required"}),r.refurbished=="false"&&e.jsxs("div",{className:"flex flex-col bg-blue-700 text-white p-3 rounded-md gap-4",children:[e.jsx("div",{className:"text-2xl font-bold",children:"Mark this Ticket Valid"}),e.jsx("div",{children:e.jsx("button",{type:"submit",onClick:m,className:"bg-gray-400 hover:bg-gray-300 text-blue-700 p-3 rounded-md font-black",children:p?e.jsx("div",{className:"p-2",children:e.jsx(g,{})}):"MARK VALID"})})]})]}),r.refurbished=="true"&&e.jsxs("div",{className:"flex flex-col bg-red-600 text-white p-3 rounded-md gap-4",children:[e.jsx("div",{className:"text-2xl font-bold",children:"Mark this Ticket In-Valid"}),e.jsx("div",{className:"bg-white p-5 rounded-md text-black",children:e.jsx("div",{children:e.jsxs("div",{className:"relative",children:[e.jsxs("select",{required:!1,onChange:t=>a(t.target.value,t.target.name),id:"reason",name:"reason",className:"peer text-black placeholder-transparent w-full py-2.5 px-5 border-gray-500 border bg-transparent rounded-sm bg-white focus-within:outline-none focus-within:border-blue-500",placeholder:"",children:[e.jsx("option",{selected:!0,disabled:!0}),A.map((t,i)=>e.jsx("option",{selected:`${r.reason}`==`${t}`,value:t,children:t},i))]}),e.jsx("label",{htmlFor:"reason",className:"absolute left-2.5 px-2.5 transition-all bg-white text-blue-black/60 text-sm -top-3 peer-placeholder-shown:text-base peer-placeholder-shown:text-gray-500 peer-placeholder-shown:top-2.5 peer-focus:-top-3 peer-focus:text-sm peer-focus:text-blue-600 peer-focus:bg-white",children:"Select Reason"})]})})}),e.jsx("div",{children:e.jsx("button",{onClick:S,className:"bg-white hover:bg-gray-300 text-red-600 p-3 rounded-md font-black",children:p?e.jsx("div",{className:"p-2",children:e.jsx(g,{})}):" MARK INVALID"})})]})]})})}export{Z as default};
