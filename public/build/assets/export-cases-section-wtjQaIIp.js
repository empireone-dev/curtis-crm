import{j as E}from"./page-CyPG1PaS.js";import{u as d,w as f}from"./xlsx-D27o5enP.js";import{u as g}from"./app-BwBx_Ofy.js";import{h as m}from"./page-HQ58WS6h.js";import"./index-BlpNTRsn.js";const r=c=>{const _=[];return Object.keys(c[0]||{}).forEach((e,l)=>{const i=Math.max(e.length,...c.map(t=>t[e]?t[e].toString().length:0));_.push({wch:i+2})}),_},k=()=>{const{users:c}=g(e=>e.users),_=c.map(e=>e.agent_type==="Warranty"||e.agent_type==="Parts"||e.agent_type==="Admin"?{id:e.id,agent:e.name,position:e.agent_type,overdue_cases:e.overdue_cases,cases_due_today:e.cases_due_today,overdue_direct_emails:e.overdue_direct_emails,direct_emails_due_today:e.direct_emails_due_today,handled_cases:e.handled_cases,handled_direct_emails:e.handled_direct_emails,upcoming_dues:e.upcoming_dues,upcoming_dues_direct_emails:e.upcoming_dues_direct_emails,handled_cases_notes:e.handled_cases_notes,handled_direct_emails_notes:e.handled_direct_emails_notes,total:parseInt(e.handled_cases)+parseInt(e.handled_direct_emails)}:null).filter(e=>e!==null),u=()=>{const e=_.map(a=>({Agent:a.agent,Position:a.position,"Cases Due Today":a.cases_due_today,"Direct Emails Due Today":a.direct_emails_due_today,"Handled Cases":a.handled_cases,"Handled Direct Emails":a.handled_direct_emails,"Overdue Cases":a.overdue_cases,"Overdue Direct Emails":a.overdue_direct_emails,"Upcoming Dues":a.upcoming_dues,"Upcoming Dues Direct Emails":a.upcoming_dues_direct_emails,Total:a.total})),l=[],i=[];_.forEach(a=>{Array.isArray(a.handled_cases_notes)&&a.handled_cases_notes.forEach(s=>{var o,y;l.push({Agent:a.agent,Ticket_ID:((o=s==null?void 0:s.ticket)==null?void 0:o.ticket_id)||"",Email:((y=s==null?void 0:s.ticket)==null?void 0:y.email)||"",Case_Status:s.case_status||"",Type:s.case_type||"",Remarks:s.remarks||"",Escalated:s.isEscalate||"",Logged_From:s.log_from||"",Created_At:m(s.created_at).format("YYYY-MM-DD HH:mm"),Updated_At:m(s.updated_at).format("YYYY-MM-DD HH:mm")})}),Array.isArray(a.handled_direct_emails_notes)&&a.handled_direct_emails_notes.forEach(s=>{var o;i.push({Agent:a.agent,Ticket_ID:"N/A",Email:((o=s==null?void 0:s.direct_email)==null?void 0:o.email)||"",Case_Status:s.case_status||"",Type:s.case_type||"",Remarks:s.remarks||"",Escalated:s.isEscalate||"",Logged_From:s.log_from||"",Created_At:m(s.created_at).format("YYYY-MM-DD HH:mm"),Updated_At:m(s.updated_at).format("YYYY-MM-DD HH:mm")})})});const t=d.book_new(),n=d.json_to_sheet(e);n["!cols"]=r(e),d.book_append_sheet(t,n,"Agent Summary");const p=d.json_to_sheet(l);p["!cols"]=r(l),d.book_append_sheet(t,p,"Handled Case Notes");const h=d.json_to_sheet(i);h["!cols"]=r(i),d.book_append_sheet(t,h,"Handled Email Notes"),f(t,"agents_with_notes.xlsx")};return E.jsx("button",{onClick:u,className:"bg-blue-600 text-white p-1.5 rounded hover:bg-blue-700",children:"Export Cases"})},b=k;export{b as default};
