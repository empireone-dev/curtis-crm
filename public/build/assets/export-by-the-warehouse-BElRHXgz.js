import{_ as h,r as x,j as y}from"./page-3qddC-Ic.js";import{e as S}from"./activities-service-BaJCmKbj.js";import{u as k,a as R}from"./xlsx-D27o5enP.js";import{h as u}from"./page-Bts9TZWZ.js";import{B as b}from"./button-2JgxEJRi.js";import"./asyncToGenerator-DKT1tr5Y.js";import"./index-rStzQJdP.js";import"./compact-item-XisaMXzl.js";import"./render-Hzza5H2S.js";var T={exports:{}};(function(_,v){(function(w,s){s()})(h,function(){function w(e,o){return typeof o>"u"?o={autoBom:!1}:typeof o!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\uFEFF",e],{type:e.type}):e}function s(e,o,t){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){l(n.response,o,t)},n.onerror=function(){console.error("could not download file")},n.send()}function f(e){var o=new XMLHttpRequest;o.open("HEAD",e,!1);try{o.send()}catch{}return 200<=o.status&&299>=o.status}function i(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var o=document.createEvent("MouseEvents");o.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(o)}}var c=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof h=="object"&&h.global===h?h:void 0,L=c.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=c.saveAs||(typeof window!="object"||window!==c?function(){}:"download"in HTMLAnchorElement.prototype&&!L?function(e,o,t){var n=c.URL||c.webkitURL,a=document.createElement("a");o=o||e.name||"download",a.download=o,a.rel="noopener",typeof e=="string"?(a.href=e,a.origin===location.origin?i(a):f(a.href)?s(e,o,t):i(a,a.target="_blank")):(a.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(a.href)},4e4),setTimeout(function(){i(a)},0))}:"msSaveOrOpenBlob"in navigator?function(e,o,t){if(o=o||e.name||"download",typeof e!="string")navigator.msSaveOrOpenBlob(w(e,t),o);else if(f(e))s(e,o,t);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){i(n)})}}:function(e,o,t,n){if(n=n||open("","_blank"),n&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return s(e,o,t);var a=e.type==="application/octet-stream",A=/constructor/i.test(c.HTMLElement)||c.safari,m=/CriOS\/[\d]+/.test(navigator.userAgent);if((m||a&&A||L)&&typeof FileReader<"u"){var d=new FileReader;d.onloadend=function(){var r=d.result;r=m?r:r.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=r:location=r,n=null},d.readAsDataURL(e)}else{var E=c.URL||c.webkitURL,p=E.createObjectURL(e);n?n.location=p:location.href=p,n=null,setTimeout(function(){E.revokeObjectURL(p)},4e4)}});c.saveAs=l.saveAs=l,_.exports=l})})(T);var D=T.exports;function I(){const[_,v]=x.useState(!1);async function w(f){try{v(!0);const i=await S();console.log("res",i),await s(i),setData(i),v(!1)}catch{v(!1)}}const s=f=>{const i=f.map(t=>{var n,a,A,m,d,E,p,r;return{"CREATED AT":u(t.ticket.created_at).format("LLL"),"UPDATED AT":u(t.ticket.updated_at).format("LLL"),"CASE FILE":t.ticket.ticket_id,FULLNAME:`${t.ticket.fname} ${t.ticket.lname}`,MODEL:t.ticket.item_number,"ITEM CLASS":t.ticket.class,BRAND:t.ticket.brand,COUNTRY:t.ticket.country,STATE:t.ticket.state,CITY:t.ticket.city,ISSUE:t.ticket.issue,"REPLACEMENT SHIP DATE":(n=t.replacement)==null?void 0:n.ship_date,"CHEQUE SHIP DATE":(a=t.refund)==null?void 0:a.ship_date,"EMAIL ADDRESS":t.ticket.email,"VALIDATION DATE":(A=t==null?void 0:t.validate)!=null&&A.created_at?u((m=t==null?void 0:t.validate)==null?void 0:m.created_at).format("LLL"):"N/A","DATE PROCESSED":((d=t==null?void 0:t.ticket)==null?void 0:d.decision_status)==="REPLACEMENT"?u((E=t==null?void 0:t.replacement_shipped)==null?void 0:E.created_at).format("L"):((p=t==null?void 0:t.ticket)==null?void 0:p.decision_status)==="REFUND"?u((r=t==null?void 0:t.refund_shipped)==null?void 0:r.created_at).format("L"):"N/A"}});console.log("datadata",i);const c=k.json_to_sheet(i),L=Object.keys(i[0]).map(t=>({wch:Math.max(t.length,...i.map(a=>a[t]?a[t].toString().length:0))+2}));c["!cols"]=L;const l=k.book_new();k.book_append_sheet(l,c,"Sheet1");const e=R(l,{bookType:"xlsx",type:"array"}),o=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});D.saveAs(o,"WAREHOUSE Data "+u().format("LLL"))};return y.jsx("div",{className:"p-3",children:y.jsx(b,{loading:_,onClick:w,color:"default",variant:"solid",children:"EXPORT RECEIVED BY THE WAREHOUSE"})})}export{I as default};
