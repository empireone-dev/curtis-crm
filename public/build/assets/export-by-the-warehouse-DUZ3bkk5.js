import{_ as d,r as _,j as b}from"./page-3qddC-Ic.js";import{e as T}from"./activities-service-BaJCmKbj.js";import{u as h,a as R}from"./xlsx-D27o5enP.js";import{h as y}from"./page-Bts9TZWZ.js";import{B as S}from"./button-2JgxEJRi.js";import"./asyncToGenerator-DKT1tr5Y.js";import"./index-rStzQJdP.js";import"./compact-item-XisaMXzl.js";import"./render-Hzza5H2S.js";var x={exports:{}};(function(v,f){(function(m,s){s()})(d,function(){function m(e,t){return typeof t>"u"?t={autoBom:!1}:typeof t!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\uFEFF",e],{type:e.type}):e}function s(e,t,r){var o=new XMLHttpRequest;o.open("GET",e),o.responseType="blob",o.onload=function(){c(o.response,t,r)},o.onerror=function(){console.error("could not download file")},o.send()}function l(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return 200<=t.status&&299>=t.status}function a(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var i=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof d=="object"&&d.global===d?d:void 0,u=i.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),c=i.saveAs||(typeof window!="object"||window!==i?function(){}:"download"in HTMLAnchorElement.prototype&&!u?function(e,t,r){var o=i.URL||i.webkitURL,n=document.createElement("a");t=t||e.name||"download",n.download=t,n.rel="noopener",typeof e=="string"?(n.href=e,n.origin===location.origin?a(n):l(n.href)?s(e,t,r):a(n,n.target="_blank")):(n.href=o.createObjectURL(e),setTimeout(function(){o.revokeObjectURL(n.href)},4e4),setTimeout(function(){a(n)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e!="string")navigator.msSaveOrOpenBlob(m(e,r),t);else if(l(e))s(e,t,r);else{var o=document.createElement("a");o.href=e,o.target="_blank",setTimeout(function(){a(o)})}}:function(e,t,r,o){if(o=o||open("","_blank"),o&&(o.document.title=o.document.body.innerText="downloading..."),typeof e=="string")return s(e,t,r);var n=e.type==="application/octet-stream",A=/constructor/i.test(i.HTMLElement)||i.safari,k=/CriOS\/[\d]+/.test(navigator.userAgent);if((k||n&&A||u)&&typeof FileReader<"u"){var E=new FileReader;E.onloadend=function(){var p=E.result;p=k?p:p.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=p:location=p,o=null},E.readAsDataURL(e)}else{var L=i.URL||i.webkitURL,w=L.createObjectURL(e);o?o.location=w:location.href=w,o=null,setTimeout(function(){L.revokeObjectURL(w)},4e4)}});i.saveAs=c.saveAs=c,v.exports=c})})(x);var j=x.exports;function I(){const[v,f]=_.useState(!1);async function m(l){try{f(!0);const a=await T();console.log("res",a),await s(a),setData(a),f(!1)}catch{f(!1)}}const s=l=>{const a=l.map(t=>({"CREATED AT":y(t.ticket.created_at).format("LLL"),"UPDATED AT":y(t.ticket.updated_at).format("LLL"),"CASE FILE":t.ticket.ticket_id,FULLNAME:`${t.ticket.fname} ${t.ticket.lname}`,MODEL:t.ticket.item_number,"ITEM CLASS":t.ticket.class,BRAND:t.ticket.brand,COUNTRY:t.ticket.country,STATE:t.ticket.state,CITY:t.ticket.city,ISSUE:t.ticket.issue}));console.log("datadata",a);const i=h.json_to_sheet(a),u=h.book_new();h.book_append_sheet(u,i,"Sheet1");const c=R(u,{bookType:"xlsx",type:"array"}),e=new Blob([c],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});j.saveAs(e,"WAREHOUSE Data"+y().format("LLL"))};return b.jsx("div",{className:"p-3",children:b.jsx(S,{loading:v,onClick:m,color:"default",variant:"solid",children:"EXPORT RECEIVED BY THE WAREHOUSE"})})}export{I as default};
