import{r as l,j as e,x as y,y as x}from"./page-DdRUgAPm.js";import{I as c}from"./input-DEU2Nfgm.js";import{S as h}from"./select-DqEutgH0.js";import{s as I}from"./receipt-service--0OYB71B.js";import{u as b,a as q}from"./app-CJgmKoRa.js";import{b as E}from"./product-search-IfNfm9Yt.js";import{L as g}from"./loading-cC9aGlE7.js";import{r as v}from"./routing-BzgBYGmF.js";import{i as k}from"./tickets-service-BITOlmJF.js";import{s as a}from"./index-Bj-9xytT.js";import"./index-cYOT7JlB.js";import"./asyncToGenerator-BHyMBGJS.js";import"./render-CDdRFazO.js";import"./CheckCircleFilled-BC4CfrEt.js";import"./pickAttrs-CvfN6BGJ.js";import"./InfoCircleFilled-DqD8uBxJ.js";import"./KeyCode-DNlgD2sM.js";import"./useCSSVarCls-BVJMh7rG.js";import"./useZIndex-DWp3nWXN.js";function z(){const{ticket:s}=b(t=>t.tickets),{user:u}=b(t=>t.app),j=q(),[N,R]=l.useState([]),[p,n]=l.useState(!1);l.useState(!1);const[r,d]=l.useState({store:null,retailers_price:"0",discount:"0",total_price:"0",refurbished:"true",notes:null,reason:""});l.useEffect(()=>{d({...r,total_price:r.retailers_price})},[r.retailers_price]),l.useEffect(()=>{async function t(o){const A=await E();R(A.map(f=>({name:f,value:f}))),s!=null&&s.receipt&&d({...s.receipt,id:s.id})}t()},[]);function i(t,o){d({...r,[o]:t})}async function m(t){if(t.preventDefault(),!r.store)a.error("Store Name is required!");else if(!r.retailers_price||r.retailers_price=="0")a.error("Retailers is required!");else if(!r.total_price||r.total_price=="0")a.error("Total Price is required!");else if(!r.notes)a.error("Notes is required!");else{n(!0);try{const o=await I({...s,...r,emp_id:u.emp_id});j(y(o.status)),n(!1),x.visit(v("decision"))}catch{n(!1)}}}async function _(){if(!r.store)a.error("Store Name is required!");else if(!r.retailers_price||r.retailers_price=="0")a.error("Retailers is required!");else if(!r.total_price||r.total_price=="0")a.error("Total Price is required!");else if(!r.notes)a.error("Notes is required!");else{n(!0);try{await k(s,r.reason,{...s,...u}),x.visit(v("files"))}catch{n(!1)}}}const S=["OOW","HAS PHYSICAL DAMAGE","REFURBISHED","UNAUTHORIZED RETAILER","NON-CURTIS PRODUCT (MODEL, SERIAL)","PHYSICAL DAMAGE - FRONT","PHYSICAL DAMAGE - BACK","SHIPPING DAMAGE","THIRD PARTY SELLER"];return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("div",{className:"text-4xl font-black",children:"Receipt details"}),e.jsxs("form",{className:"flex flex-col gap-4",onSubmit:m,children:[e.jsx(h,{onChange:i,name:"store",value:r.store,required:!0,label:"Store Name",errorMessage:"Store Name is required",data:N}),e.jsx(c,{span:"$",required:!0,onChange:i,name:"retailers_price",value:r.retailers_price,label:"Retailers Price",type:"text",errorMessage:"Retailers Price is required"}),e.jsx(c,{span:"$",onChange:i,name:"discount",value:r.discount,label:"Discount",type:"text",errorMessage:"Discount is required"}),e.jsx(c,{span:"$",required:!0,onChange:i,name:"total_price",value:parseFloat(r.retailers_price)-parseFloat(r.discount),label:"Total Price",type:"text",errorMessage:"Total Price is required"}),e.jsx(h,{onChange:i,name:"refurbished",value:r.refurbished,label:"Refurbished Logo?",errorMessage:"Refurbished is required",data:[{value:"true",name:"Yes"},{value:"false",name:"No"}]}),e.jsx(c,{onChange:i,name:"notes",value:r.notes,label:"Validation Notes",type:"text",errorMessage:"Validation Notes is required"}),r.refurbished=="false"&&e.jsxs("div",{className:"flex flex-col bg-blue-700 text-white p-3 rounded-md gap-4",children:[e.jsx("div",{className:"text-2xl font-bold",children:"Mark this Ticket Valid"}),e.jsx("div",{children:e.jsx("button",{type:"submit",onClick:m,className:"bg-gray-400 hover:bg-gray-300 text-blue-700 p-3 rounded-md font-black",children:p?e.jsx("div",{className:"p-2",children:e.jsx(g,{})}):"MARK VALID"})})]})]}),r.refurbished=="true"&&e.jsxs("div",{className:"flex flex-col bg-red-600 text-white p-3 rounded-md gap-4",children:[e.jsx("div",{className:"text-2xl font-bold",children:"Mark this Ticket In-Valid"}),e.jsx("div",{className:"bg-white p-5 rounded-md text-black",children:e.jsx("div",{children:e.jsxs("div",{className:"relative",children:[e.jsxs("select",{required:!1,onChange:t=>i(t.target.value,t.target.name),id:"reason",name:"reason",className:"peer text-black placeholder-transparent w-full py-2.5 px-5 border-gray-500 border bg-transparent rounded-sm bg-white focus-within:outline-none focus-within:border-blue-500",placeholder:"",children:[e.jsx("option",{selected:!0,disabled:!0}),S.map((t,o)=>e.jsx("option",{selected:`${r.reason}`==`${t}`,value:t,children:t},o))]}),e.jsx("label",{htmlFor:"reason",className:"absolute left-2.5 px-2.5 transition-all bg-white text-blue-black/60 text-sm -top-3 peer-placeholder-shown:text-base peer-placeholder-shown:text-gray-500 peer-placeholder-shown:top-2.5 peer-focus:-top-3 peer-focus:text-sm peer-focus:text-blue-600 peer-focus:bg-white",children:"Select Reason"})]})})}),e.jsx("div",{children:e.jsx("button",{onClick:_,className:"bg-white hover:bg-gray-300 text-red-600 p-3 rounded-md font-black",children:p?e.jsx("div",{className:"p-2",children:e.jsx(g,{})}):" MARK INVALID"})})]})]})})}export{z as default};
