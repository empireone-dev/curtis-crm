import{r as o,j as r,y as R}from"./page-ChfqELR0.js";import{I as q}from"./input-CDQr9D4H.js";import{T as D}from"./textarea-BU8VHAUK.js";import{u as S,a as U}from"./app-ChEVNUEB.js";import{L as w}from"./loading-CsUq2M4E.js";import{r as A}from"./routing-BzgBYGmF.js";import"./index-Jf1sjNCO.js";async function F(s){return(await axios.put("/api/repair/"+s.id,s)).data}async function T(s,i){return(await axios.put("/api/unrepair/"+s,i)).data}function K(){var d,l,m,f,x,h,g,_,y,j,v,C,b,E;const[s,i]=o.useState({}),{ticket:e}=S(a=>a.tickets),{user:u}=S(a=>a.app),[I,n]=o.useState(!1),[N,c]=o.useState(!1);U(),o.useEffect(()=>{var a,t;i({...e.decision_making,repair_cost:((a=e==null?void 0:e.repair)==null?void 0:a.repair_cost)??e.repair_cost,notes:((t=e==null?void 0:e.repair)==null?void 0:t.notes)??e.notes,asc_data:e.asc})},[]);function p(a,t){i(t==="repair_cost"?{...s,repair_cost:a.replace(/[^0-9.]/g,"")}:{...s,[t]:a})}async function L(a){if(confirm("Are you sure you want to mark as repaired the ticket?")){n(!0);try{const t=await F({...s,account:u,status:"REPAIR SUCCESS"});n(!1),R.visit(A("files"))}catch{n(!1)}}}async function k(a){if(confirm("Are you sure you want to mark as unrepair the ticket?")){c(!0);try{const t={...s,account:u,status:"REPAIR UNSUCCESSFUL"},P=await T(s.ticket_id,t);console.log("result",P),c(!1),R.visit(A("decision"))}catch{c(!1)}}}return r.jsxs("div",{className:"flex flex-col gap-6",children:[r.jsxs("div",{children:["ASC Name: ",((l=(d=e.asc)==null?void 0:d.user)==null?void 0:l.name)??"None"]}),r.jsxs("div",{children:["Address: ",((f=(m=e.asc)==null?void 0:m.user)==null?void 0:f.address)??"",","," ",((h=(x=e.asc)==null?void 0:x.user)==null?void 0:h.city)??"",", ",((_=(g=e.asc)==null?void 0:g.user)==null?void 0:_.state)??"",","," ",((j=(y=e.asc)==null?void 0:y.user)==null?void 0:j.zip_code)??""," Canada"]}),r.jsxs("div",{children:["Email: ",((C=(v=e.asc)==null?void 0:v.user)==null?void 0:C.email)??""]}),r.jsxs("div",{children:["Phone: ",((E=(b=e.asc)==null?void 0:b.user)==null?void 0:E.phone)??""]}),r.jsx(q,{onChange:p,name:"repair_cost",required:!0,value:(s==null?void 0:s.repair_cost)??" ",label:"Repair Cost",type:"text",errorMessage:"Repair Cost is required"}),r.jsx(D,{required:!0,onChange:p,name:"notes",value:(s==null?void 0:s.notes)??" ",label:"notes",type:"text",errorMessage:"notes is required"}),r.jsxs("div",{className:"flex gap-4",children:[r.jsx("button",{onClick:L,className:"p-2 bg-blue-500 hover:bg-blue-600 text-white rounded-md",children:I?r.jsx(w,{}):"REPAIRED"}),r.jsx("button",{onClick:k,className:"p-2 bg-red-500 hover:bg-red-600 text-white rounded-md",children:N?r.jsx(w,{}):" NOT REPAIRED"})]})]})}export{K as default};
