import{r as u,j as e,z as m,y as x}from"./page-DYpLzGDn.js";import{I as o}from"./input-DoFBkTv9.js";import{S as O}from"./select-Bj28lnCQ.js";import{u as g,a as P}from"./app-CQJA5MBt.js";import{s as p}from"./internals-service-B9kSbxh_.js";import{r as b}from"./routing-BzgBYGmF.js";import{F as N}from"./QueueListIcon-CvIHiYNy.js";import{F as R}from"./TrashIcon-B0Fqr1Y8.js";import"./index-DaPaTlHv.js";function W(){const{ticket:l,internals:j}=g(a=>a.tickets),{user:d}=g(a=>a.app),c=P(),[h,A]=u.useState(!0),[s,r]=u.useState({internal_notes:"",ticket_id:l.id,parts:[{ticket_id:l.id,name:null,part_number:null,location:null,cost:null,status:"Parts Available"}]});u.useEffect(()=>{async function a(t){await r({ticket_id:l.id,data:s,parts:j.map(n=>({id:n.id,name:n.name,part_number:n.part_number,location:n.location,cost:n.cost,status:n.status}))}),setTimeout(()=>{A(!1)},500)}a()},[h]);const v=s.parts.find(a=>a.status=="Parts Not Available"||a.status=="Not Available - On Order")!==void 0;async function w(a){if(a.preventDefault(),v){const t=await p({...s,user:d,status:"AVAILABILITY"});c(m(t.status)),x.visit(b("availability"))}else if(l.warranty_status=="OOW"){const t=await p({...s,user:d,status:"AVAILABILITY"});c(m(t.status)),x.visit(b("availability"))}else{const t=await p({...s,user:d,status:"REPLACEMENT PARTS"});c(m(t.status)),x.visit(b("replacement_parts"))}}function i(a,t,n){const f=[...s.parts];f[n][t]=a,r({...s,parts:f})}function _(){r({...s,parts:[...s.parts,{name:null,part_number:null,location:null,cost:null,status:"Parts Available"}]})}function y(a){const t=[...s.parts];t.splice(a,1),r({...s,parts:t})}return e.jsx("form",{onSubmit:w,children:e.jsxs("div",{className:"flex flex-col gap-4",children:[l.warranty_status=="IW"?e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{type:"button",className:"flex items-center rounded-md mt-3 bg-white px-2.5 py-1.5 text-sm text-green-500 font-semibold shadow-sm ring-1 ring-inset ring-green-500",children:[e.jsx(N,{className:"h-5"}),e.jsx("span",{children:"IN WARRANTY"})]}),e.jsx("i",{"aria-hidden":"true",className:"v-icon notranslate v-icon--left mdi mdi-list-status theme--light"})]}):e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{type:"button",className:"flex items-center rounded-md mt-3 bg-white px-2.5 py-1.5 text-sm text-blue-500 font-semibold shadow-sm ring-1 ring-inset ring-blue-500",children:[e.jsx(N,{className:"h-5"}),e.jsx("span",{children:"OUT OF WARRANTY"})]}),e.jsx("i",{"aria-hidden":"true",className:"v-icon notranslate v-icon--left mdi mdi-list-status theme--light"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl",children:"Availability"}),e.jsx("div",{className:"text-red-500 text-lg",children:l.validation_notes})]}),e.jsx("button",{onClick:_,className:"p-3 bg-blue-600 hover:bg-blue-700 rounded-md text-white",children:"ADD ROW"})]}),!h&&s.parts.map((a,t)=>e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(o,{ids:t,onChange:n=>i(n,"name",t),name:"name",span:"",required:!0,value:a.name??"",label:"Name",type:"text"})}),e.jsx("div",{className:"flex-1",children:e.jsx(o,{ids:t,onChange:n=>i(n,"part_number",t),name:"part_number",span:"",required:!1,value:a.part_number??"",label:"Part Number",type:"text"})}),e.jsx("div",{className:"flex-1",children:e.jsx(o,{ids:t,onChange:n=>i(n,"location",t),name:"location",span:"",required:!1,value:a.location??"",label:"Location",type:"text"})}),e.jsx("div",{className:"flex-1",children:e.jsx(o,{ids:t,onChange:n=>i(n,"cost",t),name:"cost",span:"",required:!1,value:a.cost??"",label:"Cost",type:"text"})}),e.jsx("div",{className:"flex-1",children:e.jsx(O,{ids:t,onChange:i,name:"status",required:!1,value:a.status??null,label:"status",errorMessage:"",data:[{value:"Parts Available",name:"Parts Available"},{value:"Parts Not Available",name:"Parts Not Available"},{value:"Not Available - On Order",name:"Not Available - On Order"}]})}),e.jsx("button",{className:"border border-red-500 rounded-md flex-none text-red-500 p-2.5",onClick:()=>y(t),children:e.jsx(R,{className:"h-6"})})]},t)),e.jsx("div",{children:e.jsx(o,{onChange:a=>r({...s,internal_notes:a}),name:"internal_notes",span:"",required:!1,value:(s==null?void 0:s.internal_notes)??"",label:"Internal Notes",type:"text"})}),l.warranty_status=="OOW"?e.jsx("button",{className:"p-3 rounded-md bg-green-500 hover:bg-green-600 text-white w-96",children:"PROCEED"}):v?e.jsx("button",{className:"p-3 rounded-md bg-green-500 hover:bg-green-600 text-white w-96",children:"PROCEED"}):e.jsx("button",{className:"p-3 rounded-md bg-green-500 hover:bg-green-600 text-white w-96",children:"MOVE TO REPLACEMENT"})]})})}export{W as default};
