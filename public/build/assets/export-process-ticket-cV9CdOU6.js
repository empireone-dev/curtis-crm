import{r as t,j as c}from"./page-DVVVTcK8.js";import{u as d,w as i}from"./xlsx-D27o5enP.js";import{e as m}from"./tickets-service-Dd6TZU9l.js";import{h as n}from"./page-DvrW8j-3.js";import{M as oo}from"./index-znBrpNxL.js";import{D as ro}from"./index-da0JR6Aj.js";import"./asyncToGenerator-c5WsSbRn.js";import"./index-NpFDK0km.js";import"./render-BRlc8Cs-.js";import"./CheckCircleFilled-Bqw-tjCA.js";import"./pickAttrs-9XeDcI0h.js";import"./InfoCircleFilled-CPOxogNa.js";import"./useZIndex-6gEWSy-s.js";import"./motion-4S5rSXvC.js";import"./button-DkbuceU6.js";import"./compact-item-C59iAMoG.js";import"./Modal-rs1HwPza.js";import"./index-CU412VwI.js";import"./motion-DFvW847i.js";import"./KeyCode-DNlgD2sM.js";import"./fade-SZNI46jg.js";import"./zoom-CE_WZ1p1.js";import"./ContextIsolator-aTGfB0Im.js";import"./useClosable-B4PLtd1v.js";import"./useCSSVarCls-CiTpdV9Y.js";import"./useLocale-DWkRg3Vy.js";import"./PurePanel-CT9Ru5XO.js";import"./index-BSrukfaA.js";import"./Overflow-CenF6-R1.js";import"./useIcons-Dcz8iNHF.js";import"./CheckOutlined-2IiIubcb.js";import"./DownOutlined-C-alg6E4.js";import"./index-DunZ_XeJ.js";import"./roundedArrow--fhCWMcx.js";const{RangePicker:ao}=ro;function Io(){const[W,p]=t.useState(!1),[e,G]=t.useState([]),[H,l]=t.useState(!1),J=(s,a)=>{G(a),console.log("Selected Dates:",a)};function Q(s,a="export.xlsx"){const r=d.json_to_sheet(s),o=d.book_new();d.book_append_sheet(o,r,"Sheet1"),i(o,a)}async function $(){var s,a;l(!0);try{const r=await m({start:e[0],end:e[1]});((s=r==null?void 0:r.result)==null?void 0:s.length)>0?Q((a=r==null?void 0:r.result)==null?void 0:a.map(o=>{var u,k,h,f,_,x,C,D,g,L,S,b,y,P,R,w,E,T,j,q,N,A,M,v,O,U,Y,I,X,F,Z,z,B,K,V;return{"Date Created":n((u=o==null?void 0:o.ticket)==null?void 0:u.created_at).format("LLL")||"","Date Last Updated":n((k=o==null?void 0:o.cases_log)==null?void 0:k.created_at).format("LLL")||"","Ticket #":((h=o==null?void 0:o.ticket)==null?void 0:h.ticket_id)||"","First Name":((f=o==null?void 0:o.ticket)==null?void 0:f.fname)||"","Last Name":((_=o==null?void 0:o.ticket)==null?void 0:_.lname)||"",Phone:((x=o==null?void 0:o.ticket)==null?void 0:x.phone)||"",Email:((C=o==null?void 0:o.ticket)==null?void 0:C.email)||"","Serial #":((D=o==null?void 0:o.ticket)==null?void 0:D.serial_number)||"","Model #":((g=o==null?void 0:o.ticket)==null?void 0:g.item_number)||"","Unit Item":((L=o==null?void 0:o.ticket)==null?void 0:L.unit)||"",Class:((S=o==null?void 0:o.ticket)==null?void 0:S.class)||"",Brand:((b=o==null?void 0:o.ticket)==null?void 0:b.brand)||"",Resolution:((y=o==null?void 0:o.ticket)==null?void 0:y.call_type)||"","Purchase Date":n((P=o==null?void 0:o.ticket)==null?void 0:P.purchase_date).format("LL")||"",Zipcode:((R=o==null?void 0:o.ticket)==null?void 0:R.Zip_code)||"",Country:((w=o==null?void 0:o.ticket)==null?void 0:w.country)||"",State:((E=o==null?void 0:o.ticket)==null?void 0:E.state)||"",City:((T=o==null?void 0:o.ticket)==null?void 0:T.city)||"",Address:o.address||"",Issue:((j=o==null?void 0:o.ticket)==null?void 0:j.issue)||"","Ticket Status":((q=o==null?void 0:o.ticket)==null?void 0:q.status)||"",Reason:((N=o==null?void 0:o.ticket)==null?void 0:N.reason_to_close)||"",Discount:((A=o==null?void 0:o.decision)==null?void 0:A.discount)||"","Price After Discount":((M=o==null?void 0:o.decision)==null?void 0:M.after_discount)||"","Purchase Price":((v=o==null?void 0:o.decision)==null?void 0:v.retailers_price)||"","Cost Price":((O=o==null?void 0:o.decision)==null?void 0:O.cost_of_unit)||"","Shipping Cost":o.shippingCost||"","Replacement Ship Date":((U=o==null?void 0:o.decision)==null?void 0:U.date)||"","Tracking #":(((Y=o.replacement)==null?void 0:Y.tracking)??"N/A")||"","Cheque Ship Date":((I=o==null?void 0:o.refund)==null?void 0:I.ship_date)||"","Cheque #":((X=o==null?void 0:o.refund)==null?void 0:X.cheque_no)||"","Cheque Amount":((F=o==null?void 0:o.refund)==null?void 0:F.cheque_amount)||"","Cheque Currency":((Z=o==null?void 0:o.ticket)==null?void 0:Z.country)=="US"?"USD":"CAD","Retail Store":((z=o==null?void 0:o.receipt)==null?void 0:z.store)||"","Warranty Decision":((B=o==null?void 0:o.ticket)==null?void 0:B.decision_status)||"","Validation Date":n((K=o==null?void 0:o.validate)==null?void 0:K.created_at).format("LL")||"","Date Processed":n((V=o==null?void 0:o.replacement_shipped)==null?void 0:V.created_at).format("LLL")||""}})):console.warn("No data to export."),l(!1),p(!1)}catch(r){console.error("Export failed",r),l(!1)}}return c.jsxs("div",{children:[c.jsx("button",{onClick:()=>p(!0),className:"bg-blue-500 hover:bg-blue-600 p-2 rounded-md text-white",children:"EXPORT PROCESS TICKET"}),c.jsxs(oo,{confirmLoading:H,onOk:$,onCancel:()=>p(!1),okText:"Export",open:W,children:[c.jsx("label",{className:"block text-sm mb-2",children:"Select Date Range:"}),c.jsx(ao,{onChange:J,format:"DD-MM-YYYY",allowClear:!0,size:"large",style:{width:"100%"}})]})]})}export{Io as default};
