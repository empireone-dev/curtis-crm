import{j as E}from"./page-DdRUgAPm.js";import{u as d,w as k}from"./xlsx-D27o5enP.js";import{u as f}from"./app-bdGdUivf.js";import{h as m}from"./page-DqVict88.js";import"./index-cYOT7JlB.js";const r=o=>{const _=[];return Object.keys(o[0]||{}).forEach((e,l)=>{const i=Math.max(e.length,...o.map(t=>t[e]?t[e].toString().length:0));_.push({wch:i+2})}),_},g=()=>{const{users:o}=f(e=>e.users),_=o.map(e=>e.agent_type==="Warranty"||e.agent_type==="Parts"||e.agent_type==="Admin"?{id:e.id,agent:e.name,position:e.agent_type,overdue_cases:e.overdue_cases,cases_due_today:e.cases_due_today,overdue_direct_emails:e.overdue_direct_emails,direct_emails_due_today:e.direct_emails_due_today,handled_cases:e.handled_cases,handled_direct_emails:e.handled_direct_emails,upcoming_dues:e.upcoming_dues,upcoming_dues_direct_emails:e.upcoming_dues_direct_emails,handled_cases_notes:e.handled_cases_notes,handled_direct_emails_notes:e.handled_direct_emails_notes,total:parseInt(e.handled_cases)+parseInt(e.handled_direct_emails)}:null).filter(e=>e!==null),u=()=>{const e=_.map(a=>({Agent:a.agent,Position:a.position,"Cases Due Today":a.cases_due_today,"Direct Emails Due Today":a.direct_emails_due_today,"Handled Cases":a.handled_cases,"Handled Direct Emails":a.handled_direct_emails,"Overdue Cases":a.overdue_cases,"Overdue Direct Emails":a.overdue_direct_emails,"Upcoming Dues":a.upcoming_dues,"Upcoming Dues Direct Emails":a.upcoming_dues_direct_emails,Total:a.total})),l=[],i=[];_.forEach(a=>{Array.isArray(a.handled_cases_notes)&&a.handled_cases_notes.forEach(s=>{var c,y;l.push({Agent:a.agent,Ticket_ID:((c=s==null?void 0:s.ticket)==null?void 0:c.ticket_id)||"",Email:((y=s==null?void 0:s.ticket)==null?void 0:y.email)||"",Case_Status:s.case_status||"",Type:s.case_type||"",Remarks:s.remarks||"",Escalated:s.isEscalate||"",Logged_From:s.log_from||"",Created_At:m(s.created_at).format("YYYY-MM-DD HH:mm"),Updated_At:m(s.updated_at).format("YYYY-MM-DD HH:mm")})}),Array.isArray(a.handled_direct_emails_notes)&&a.handled_direct_emails_notes.forEach(s=>{var c;i.push({Agent:a.agent,Ticket_ID:(s==null?void 0:s.id)||"",Email:((c=s==null?void 0:s.ticket)==null?void 0:c.email)||"",Case_Status:s.case_status||"",Type:s.case_type||"",Remarks:s.remarks||"",Escalated:s.isEscalate||"",Logged_From:s.log_from||"",Created_At:m(s.created_at).format("YYYY-MM-DD HH:mm"),Updated_At:m(s.updated_at).format("YYYY-MM-DD HH:mm")})})});const t=d.book_new(),n=d.json_to_sheet(e);n["!cols"]=r(e),d.book_append_sheet(t,n,"Agent Summary");const p=d.json_to_sheet(l);p["!cols"]=r(l),d.book_append_sheet(t,p,"Handled Case Notes");const h=d.json_to_sheet(i);h["!cols"]=r(i),d.book_append_sheet(t,h,"Handled Email Notes"),k(t,"agents_with_notes.xlsx")};return E.jsx("button",{onClick:u,className:"bg-blue-600 text-white p-1.5 rounded hover:bg-blue-700",children:"Export Cases"})},b=g;export{b as default};
