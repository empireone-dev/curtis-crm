import{j as y}from"./page-3qddC-Ic.js";import{u as d,w as E}from"./xlsx-D27o5enP.js";import{u as k}from"./app-Dh-28WfB.js";import{h as l}from"./page-Bts9TZWZ.js";import"./index-rStzQJdP.js";const m=i=>{const _=[];return Object.keys(i[0]||{}).forEach((e,r)=>{const o=Math.max(e.length,...i.map(t=>t[e]?t[e].toString().length:0));_.push({wch:o+2})}),_},f=()=>{const{users:i}=k(e=>e.users),_=i.map(e=>e.agent_type==="Warranty"||e.agent_type==="Parts"||e.agent_type==="Admin"?{id:e.id,agent:e.name,position:e.agent_type,overdue_cases:e.overdue_cases,cases_due_today:e.cases_due_today,overdue_direct_emails:e.overdue_direct_emails,direct_emails_due_today:e.direct_emails_due_today,handled_cases:e.handled_cases,handled_direct_emails:e.handled_direct_emails,upcoming_dues:e.upcoming_dues,upcoming_dues_direct_emails:e.upcoming_dues_direct_emails,handled_cases_notes:e.handled_cases_notes,handled_direct_emails_notes:e.handled_direct_emails_notes,total:parseInt(e.handled_cases)+parseInt(e.handled_direct_emails)}:null).filter(e=>e!==null),n=()=>{const e=_.map(a=>({Agent:a.agent,Position:a.position,"Cases Due Today":a.cases_due_today,"Direct Emails Due Today":a.direct_emails_due_today,"Handled Cases":a.handled_cases,"Handled Direct Emails":a.handled_direct_emails,"Overdue Cases":a.overdue_cases,"Overdue Direct Emails":a.overdue_direct_emails,"Upcoming Dues":a.upcoming_dues,"Upcoming Dues Direct Emails":a.upcoming_dues_direct_emails,Total:a.total})),r=[],o=[];_.forEach(a=>{Array.isArray(a.handled_cases_notes)&&a.handled_cases_notes.forEach(s=>{var c;r.push({Agent:a.agent,Ticket_ID:((c=s==null?void 0:s.ticket)==null?void 0:c.ticket_id)||"",Case_Status:s.case_status||"",Type:s.case_type||"",Remarks:s.remarks||"",Escalated:s.isEscalate||"",Logged_From:s.log_from||"",Created_At:l(s.created_at).format("YYYY-MM-DD HH:mm"),Updated_At:l(s.updated_at).format("YYYY-MM-DD HH:mm")})}),Array.isArray(a.handled_direct_emails_notes)&&a.handled_direct_emails_notes.forEach(s=>{var c;o.push({Agent:a.agent,Ticket_ID:((c=s==null?void 0:s.ticket)==null?void 0:c.ticket_id)||"",Case_Status:s.case_status||"",Type:s.case_type||"",Remarks:s.remarks||"",Escalated:s.isEscalate||"",Logged_From:s.log_from||"",Created_At:l(s.created_at).format("YYYY-MM-DD HH:mm"),Updated_At:l(s.updated_at).format("YYYY-MM-DD HH:mm")})})});const t=d.book_new(),u=d.json_to_sheet(e);u["!cols"]=m(e),d.book_append_sheet(t,u,"Agent Summary");const p=d.json_to_sheet(r);p["!cols"]=m(r),d.book_append_sheet(t,p,"Handled Case Notes");const h=d.json_to_sheet(o);h["!cols"]=m(o),d.book_append_sheet(t,h,"Handled Email Notes"),E(t,"agents_with_notes.xlsx")};return y.jsx("button",{onClick:n,className:"bg-blue-600 text-white p-1.5 rounded hover:bg-blue-700",children:"Export Cases"})},H=f;export{H as default};
