import{_ as h,r as x,j as T}from"./page-BNpu25Vy.js";import{e as R}from"./activities-service-BaJCmKbj.js";import{u as k,a as b}from"./xlsx-D27o5enP.js";import{h as d}from"./page-DBtsZyPx.js";import{B as D}from"./button-CTMOoJJC.js";import"./asyncToGenerator-y2MD6EK_.js";import"./index-oSI6-JwC.js";import"./compact-item-LZnqzSXy.js";import"./render-C8EwcgY9.js";var S={exports:{}};(function(_,v){(function(L,l){l()})(h,function(){function L(e,o){return typeof o>"u"?o={autoBom:!1}:typeof o!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),o={autoBom:!o}),o.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\uFEFF",e],{type:e.type}):e}function l(e,o,t){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){s(n.response,o,t)},n.onerror=function(){console.error("could not download file")},n.send()}function f(e){var o=new XMLHttpRequest;o.open("HEAD",e,!1);try{o.send()}catch{}return 200<=o.status&&299>=o.status}function i(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var o=document.createEvent("MouseEvents");o.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(o)}}var c=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof h=="object"&&h.global===h?h:void 0,w=c.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),s=c.saveAs||(typeof window!="object"||window!==c?function(){}:"download"in HTMLAnchorElement.prototype&&!w?function(e,o,t){var n=c.URL||c.webkitURL,a=document.createElement("a");o=o||e.name||"download",a.download=o,a.rel="noopener",typeof e=="string"?(a.href=e,a.origin===location.origin?i(a):f(a.href)?l(e,o,t):i(a,a.target="_blank")):(a.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(a.href)},4e4),setTimeout(function(){i(a)},0))}:"msSaveOrOpenBlob"in navigator?function(e,o,t){if(o=o||e.name||"download",typeof e!="string")navigator.msSaveOrOpenBlob(L(e,t),o);else if(f(e))l(e,o,t);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){i(n)})}}:function(e,o,t,n){if(n=n||open("","_blank"),n&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return l(e,o,t);var a=e.type==="application/octet-stream",A=/constructor/i.test(c.HTMLElement)||c.safari,m=/CriOS\/[\d]+/.test(navigator.userAgent);if((m||a&&A||w)&&typeof FileReader<"u"){var p=new FileReader;p.onloadend=function(){var r=p.result;r=m?r:r.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=r:location=r,n=null},p.readAsDataURL(e)}else{var E=c.URL||c.webkitURL,u=E.createObjectURL(e);n?n.location=u:location.href=u,n=null,setTimeout(function(){E.revokeObjectURL(u)},4e4)}});c.saveAs=s.saveAs=s,_.exports=s})})(S);var j=S.exports;function F(){const[_,v]=x.useState(!1);async function L(f){try{v(!0);const i=await R();console.log("res",i),await l(i),setData(i),v(!1)}catch{v(!1)}}const l=f=>{const i=f.map(t=>{var n,a,A,m,p,E,u,r,y;return{"CREATED AT":d(t.ticket.created_at).format("LLL"),"UPDATED AT":d(t.ticket.updated_at).format("LLL"),"CASE FILE":t.ticket.ticket_id,FULLNAME:`${t.ticket.fname} ${t.ticket.lname}`,MODEL:t.ticket.item_number,"ITEM CLASS":t.ticket.class,BRAND:t.ticket.brand,COUNTRY:t.ticket.country,STATE:t.ticket.state,CITY:t.ticket.city,ISSUE:t.ticket.issue,"REPLACEMENT SHIP DATE":(n=t.replacement)==null?void 0:n.ship_date,"CHEQUE SHIP DATE":(a=t.refund)==null?void 0:a.ship_date,"EMAIL ADDRESS":t.ticket.email,"VALIDATION DATE":(A=t==null?void 0:t.validate)!=null&&A.created_at?d((m=t==null?void 0:t.validate)==null?void 0:m.created_at).format("LLL"):"N/A","DATE PROCESSED":((p=t==null?void 0:t.ticket)==null?void 0:p.decision_status)==="REPLACEMENT"?d((E=t==null?void 0:t.replacement_shipped)==null?void 0:E.created_at).format("L"):((u=t==null?void 0:t.ticket)==null?void 0:u.decision_status)==="REFUND"?d((r=t==null?void 0:t.refund_shipped)==null?void 0:r.created_at).format("L"):"N/A","DECISION MAKING DATE":d((y=t==null?void 0:t.decision)==null?void 0:y.created_at).format("L")}});console.log("datadata",i);const c=k.json_to_sheet(i),w=Object.keys(i[0]).map(t=>({wch:Math.max(t.length,...i.map(a=>a[t]?a[t].toString().length:0))+2}));c["!cols"]=w;const s=k.book_new();k.book_append_sheet(s,c,"Sheet1");const e=b(s,{bookType:"xlsx",type:"array"}),o=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});j.saveAs(o,"WAREHOUSE Data "+d().format("LLL"))};return T.jsx("div",{className:"p-3",children:T.jsx(D,{loading:_,onClick:L,color:"default",variant:"solid",children:"EXPORT RECEIVED BY THE WAREHOUSE"})})}export{F as default};
